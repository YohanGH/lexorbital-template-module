{
  "$schema": "http://json-schema.org/draft-07/schema#",
  "$id": "https://lexorbital.dev/schemas/module-manifest.v1.json",
  "title": "LexOrbital Module Manifest",
  "description": "Schema for LexOrbital module manifest files",
  "type": "object",
  "required": [
    "name",
    "description",
    "type",
    "version",
    "entryPoints",
    "lexorbital",
    "maintainer",
    "repository",
    "license"
  ],
  "properties": {
    "$schema": {
      "type": "string",
      "description": "JSON Schema reference"
    },
    "name": {
      "type": "string",
      "pattern": "^lexorbital-[a-z0-9-]+$",
      "not": {
        "enum": ["lexorbital-template-module"]
      },
      "description": "Module name following lexorbital-* convention (must not be the template default name)"
    },
    "description": {
      "type": "string",
      "minLength": 10,
      "maxLength": 500,
      "description": "Module description"
    },
    "type": {
      "type": "string",
      "enum": [
        "utility",
        "service",
        "ui-component",
        "data-provider",
        "middleware",
        "plugin",
        "theme",
        "integration",
        "library"
      ],
      "description": "Module type classification"
    },
    "version": {
      "type": "string",
      "pattern": "^(0|[1-9]\\d*)\\.(0|[1-9]\\d*)\\.(0|[1-9]\\d*)(?:-((?:0|[1-9]\\d*|\\d*[a-zA-Z-][0-9a-zA-Z-]*)(?:\\.(?:0|[1-9]\\d*|\\d*[a-zA-Z-][0-9a-zA-Z-]*))*))?(?:\\+([0-9a-zA-Z-]+(?:\\.[0-9a-zA-Z-]+)*))?$",
      "description": "Semantic version (semver)"
    },
    "entryPoints": {
      "type": "object",
      "required": ["main"],
      "properties": {
        "main": {
          "type": "string",
          "pattern": "^dist/.+\\.js$",
          "description": "Main entry point (JavaScript)"
        },
        "types": {
          "type": "string",
          "pattern": "^dist/.+\\.d\\.ts$",
          "description": "TypeScript definitions entry point"
        },
        "module": {
          "type": "string",
          "pattern": "^dist/.+\\.mjs$",
          "description": "ES module entry point"
        }
      },
      "additionalProperties": false
    },
    "lexorbital": {
      "type": "object",
      "required": ["role", "layer", "compatibility"],
      "properties": {
        "role": {
          "type": "string",
          "not": {
            "enum": ["template-module"]
          },
          "minLength": 3,
          "description": "Module role in the ecosystem (must not be 'template-module')"
        },
        "layer": {
          "type": "string",
          "enum": [
            "infrastructure",
            "domain",
            "application",
            "presentation",
            "integration"
          ],
          "description": "Architectural layer"
        },
        "compatibility": {
          "type": "object",
          "required": ["metaKernel"],
          "properties": {
            "metaKernel": {
              "type": "string",
              "pattern": "^[><=~^]+[0-9]",
              "description": "Compatible metaKernel version range"
            }
          },
          "additionalProperties": {
            "type": "string"
          }
        },
        "tags": {
          "type": "array",
          "items": {
            "type": "string",
            "minLength": 2
          },
          "minItems": 1,
          "uniqueItems": true,
          "description": "Module tags for categorization"
        },
        "dependencies": {
          "type": "object",
          "properties": {
            "required": {
              "type": "array",
              "items": {
                "type": "string"
              },
              "uniqueItems": true
            },
            "optional": {
              "type": "array",
              "items": {
                "type": "string"
              },
              "uniqueItems": true
            }
          },
          "additionalProperties": false
        }
      },
      "additionalProperties": false
    },
    "maintainer": {
      "type": "object",
      "required": ["name", "contact"],
      "properties": {
        "name": {
          "type": "string",
          "not": {
            "enum": ["LexOrbital Core"]
          },
          "minLength": 2,
          "description": "Maintainer name (should be customized from template default)"
        },
        "contact": {
          "type": "string",
          "anyOf": [
            {
              "format": "email"
            },
            {
              "format": "uri"
            }
          ],
          "description": "Maintainer contact (email or URL)"
        }
      },
      "additionalProperties": false
    },
    "repository": {
      "type": "object",
      "required": ["type", "url"],
      "properties": {
        "type": {
          "type": "string",
          "enum": ["git", "svn", "hg"],
          "description": "Repository type"
        },
        "url": {
          "type": "string",
          "format": "uri",
          "not": {
            "enum": ["https://github.com/YohanGH/lexorbital-template-module"]
          },
          "description": "Repository URL (must be customized from template default)"
        }
      },
      "additionalProperties": false
    },
    "license": {
      "type": "string",
      "minLength": 2,
      "description": "License identifier (SPDX)"
    },
    "documentation": {
      "type": "object",
      "properties": {
        "readme": {
          "type": "string",
          "format": "uri"
        },
        "website": {
          "type": "string",
          "format": "uri"
        },
        "apiDocs": {
          "type": "string",
          "format": "uri"
        }
      },
      "additionalProperties": false
    }
  },
  "additionalProperties": false
}

